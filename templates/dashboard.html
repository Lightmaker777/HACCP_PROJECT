<!-- dashboard.html -->
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HACCP Dashboard - Bee United UG</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #ffffff;
      font-family: 'Arial', sans-serif;
    }
    .card {
      border-radius: 10px;
      margin-bottom: 20px;
    }
    .nav-link {
      padding: 10px 20px;
      border-radius: 5px;
      margin: 5px;
      text-align: center;
      background-color: #292625;
      color: white;
      text-decoration: none;
    }
    .nav-link:hover {
      background-color: #e6bd39;
    }
    .container {
      max-width: 1200px;
      margin-top: 30px;
    }
    h1 {
      text-align: center;
      color: #343a40;
    }
    .dashboard-card {
      text-align: center;
      padding: 20px;
      background-color: #f3f2e2;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .quiz {
      margin-top: 20px;
      text-align: left;
    }
    .quiz label {
      display: block;
    }
  </style>
</head>
<body>

  
  
<div class="container">
  <div style="display: flex; align-items: center; justify-content: space-between; padding: 10px 20px;">
    <img src="/static/images/logo.jpg" alt="Logo" style="height: 70px;">
    <h1 style="flex: 1; text-align: center; margin: 0;">HACCP Dashboard ‚Äì Bee United UG</h1>
  </div>
  
  

  <!-- Navigation Menu -->
  <div class="d-flex justify-content-center flex-wrap mb-4">

    <!-- Button zum √ñffnen des Modal f√ºr neue Mitarbeiter -->
    <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#instructionModal">
      <i class="fas fa-user-plus"></i>  Anweisungen lesen und best√§tigen
    </a>
    

    <a href="#produkte" class="nav-link"><i class="fas fa-cogs"></i> Produktbeschreibung</a>
    <a href="#verpackung" class="nav-link"><i class="fas fa-box"></i> Verpackung und Kontakt</a>
    <a href="#lagerung" class="nav-link"><i class="fas fa-warehouse"></i> Lagerung des Honigs</a>
    <a href="#hygiene" class="nav-link"><i class="fas fa-user-check"></i> Hygiene und Kleidung</a>
    <a href="#dokumente" class="nav-link"><i class="fas fa-file-alt"></i> Dokumentation</a>
    <a href="#reinigung" class="nav-link"><i class="fas fa-broom"></i> Reinigung und Wartung</a>
    <a href="#sicherheit" class="nav-link"><i class="fas fa-shield-alt"></i> Sicherheitsvorkehrungen</a>
  </div>


  <div class="row mt-4">

    <!-- Dokumentation -->
    <div class="col-md-6" id="dokumentation">
      <div class="card dashboard-card">
        <h5><i class="fas fa-file-alt"></i> Dokumentation</h5>
        <p>Stelle sicher, dass alle Dokumente den aktuellen HACCP-Anforderungen entsprechen.</p>
        <ul class="list-group mb-3">
          <li class="list-group-item"><input type="checkbox"> Lieferscheine vorhanden</li>
          <li class="list-group-item"><input type="checkbox"> R√ºckverfolgbarkeit gew√§hrleistet</li>
          <li class="list-group-item"><input type="checkbox"> Temperaturprotokolle aktuell</li>
        </ul>
        <button class="btn btn-warning" onclick="toggleQuiz('quizDoku')">Quiz starten</button>
        <div class="quiz mt-3" id="quizDoku" style="display:none;">
          <p><strong>Frage 1:</strong> Welche Dokumente m√ºssen bei Wareneingang vorhanden sein?</p>
          <label><input type="radio" name="qD1" value="1"> Lieferschein & Temperaturprotokoll</label><br>
          <label><input type="radio" name="qD1" value="0"> Nur Rechnung</label><br>
          <label><input type="radio" name="qD1" value="0"> Keine</label><br>
          <button class="btn btn-success mt-2" id="check-qD1">Antwort pr√ºfen</button>
          <div id="result-qD1" class="mt-2"></div>
        </div>
      </div>
    </div>
  
    <!-- Produktbeschreibung -->
    <div class="col-md-6" id="produkte">
      <div class="card dashboard-card">
        <h5><i class="fas fa-cogs"></i> Produktbeschreibung</h5>
        <p>Validiere die Informationen zu den Honigprodukten und deren Herkunft gem√§√ü HACCP.</p>
        <ul class="list-group mb-3">
          <li class="list-group-item"><input type="checkbox"> QSI- und Honigverordnung vorhanden</li>
          <li class="list-group-item"><input type="checkbox"> Herkunft dokumentiert</li>
          <li class="list-group-item"><input type="checkbox"> Temperatur bei Ankunft √ºberpr√ºft</li>
        </ul>
        <button class="btn btn-warning" onclick="toggleQuiz('quiz1')">Quiz starten</button>
        <div class="quiz mt-3" id="quiz1" style="display:none;">
          <p><strong>Frage 1:</strong> Welche Zertifikate m√ºssen f√ºr den Honig vorliegen?</p>
          <label><input type="radio" name="q1" value="1"> QSI und Honigverordnung</label><br>
          <label><input type="radio" name="q1" value="0"> Nur das Lieferantenzertifikat</label><br>
          <label><input type="radio" name="q1" value="0"> Keine Zertifikate erforderlich</label><br>
          <button class="btn btn-success mt-2" id="check-q1">Antwort pr√ºfen</button>
          <div id="result-q1" class="mt-2"></div>
        </div>
      </div>
    </div>
  
    <!-- Verpackung -->
    <div class="col-md-6" id="verpackung">
      <div class="card dashboard-card">
        <h5><i class="fas fa-box"></i> Verpackung</h5>
        <p>Stelle sicher, dass Verpackungsmaterialien HACCP-konform sind.</p>
        <ul class="list-group mb-3">
          <li class="list-group-item"><input type="checkbox"> Unbesch√§digte Verpackung</li>
          <li class="list-group-item"><input type="checkbox"> Lebensmittelecht (Kennzeichnung vorhanden)</li>
          <li class="list-group-item"><input type="checkbox"> Frei von Fremdk√∂rpern</li>
        </ul>
        <button class="btn btn-warning" onclick="toggleQuiz('quiz2')">Quiz starten</button>
        <div class="quiz mt-3" id="quiz2" style="display:none;">
          <p><strong>Frage 1:</strong> Welche Verpackung ist HACCP-konform?</p>
          <label><input type="radio" name="q2" value="1"> Unversehrte, lebensmittelechte Verpackung</label><br>
          <label><input type="radio" name="q2" value="0"> Recyclingmaterial mit Rissen</label><br>
          <label><input type="radio" name="q2" value="0"> Offene Kartons</label><br>
          <button class="btn btn-success mt-2" id="check-q2">Antwort pr√ºfen</button>
          <div id="result-q2" class="mt-2"></div>
        </div>
      </div>
    </div>
  
    <!-- Lagerung -->
    <div class="col-md-6" id="lagerung">
      <div class="card dashboard-card">
        <h5><i class="fas fa-warehouse"></i> Lagerung</h5>
        <p>Kontrolliere die Lagerbedingungen gem√§√ü HACCP-Anforderungen.</p>
        <ul class="list-group mb-3">
          <li class="list-group-item"><input type="checkbox"> Temperatur im gr√ºnen Bereich</li>
          <li class="list-group-item"><input type="checkbox"> Produkte nicht direkt am Boden gelagert</li>
          <li class="list-group-item"><input type="checkbox"> Luftzirkulation gew√§hrleistet</li>
        </ul>
        <button class="btn btn-warning" onclick="toggleQuiz('quiz3')">Quiz starten</button>
        <div class="quiz mt-3" id="quiz3" style="display:none;">
          <p><strong>Frage 1:</strong> Wie sollte Honig gelagert werden?</p>
          <label><input type="radio" name="q3" value="1"> K√ºhl, trocken, lichtgesch√ºtzt</label><br>
          <label><input type="radio" name="q3" value="0"> Im Freien</label><br>
          <label><input type="radio" name="q3" value="0"> Direkt auf dem Boden</label><br>
          <button class="btn btn-success mt-2" id="check-q3">Antwort pr√ºfen</button>
          <div id="result-q3" class="mt-2"></div>
        </div>
      </div>
    </div>
  
    <!-- Hygiene -->
    <div class="col-md-6" id="hygiene">
      <div class="card dashboard-card">
        <h5><i class="fas fa-broom"></i> Hygiene</h5>
        <p>Stelle sicher, dass alle hygienischen Standards im Lagerbereich eingehalten werden.</p>
        <ul class="list-group mb-3">
          <li class="list-group-item"><input type="checkbox"> Keine Sch√§dlingsspuren sichtbar</li>
          <li class="list-group-item"><input type="checkbox"> Saubere B√∂den und Fl√§chen</li>
          <li class="list-group-item"><input type="checkbox"> Reinigungspl√§ne vorhanden</li>
        </ul>
        <button class="btn btn-warning" onclick="toggleQuiz('quiz4')">Quiz starten</button>
        <div class="quiz mt-3" id="quiz4" style="display:none;">
          <p><strong>Frage 1:</strong> Was ist ein Zeichen f√ºr gute Hygiene im Lager?</p>
          <label><input type="radio" name="q4" value="1"> Saubere B√∂den, keine Sch√§dlinge</label><br>
          <label><input type="radio" name="q4" value="0"> Lebensmittelreste auf dem Boden</label><br>
          <label><input type="radio" name="q4" value="0"> Unbekannte Ger√ºche</label><br>
          <button class="btn btn-success mt-2" id="check-q4">Antwort pr√ºfen</button>
          <div id="result-q4" class="mt-2"></div>
        </div>
      </div>
    </div>

    <!-- Reinigung -->
    <div class="col-md-6" id="reinigung">
      <div class="card dashboard-card">
        <h5><i class="fas fa-soap"></i> Reinigung</h5>
        <p>√úberpr√ºfe, ob Reinigungsma√ünahmen korrekt dokumentiert und durchgef√ºhrt wurden.</p>
        <ul class="list-group mb-3">
          <li class="list-group-item"><input type="checkbox"> Reinigungspl√§ne sichtbar und aktuell</li>
          <li class="list-group-item"><input type="checkbox"> Dokumentation vollst√§ndig</li>
          <li class="list-group-item"><input type="checkbox"> Reinigungsmittel korrekt gelagert</li>
        </ul>
        <button class="btn btn-warning" onclick="toggleQuiz('quiz5')">Quiz starten</button>
        <div class="quiz mt-3" id="quiz5" style="display:none;">
          <p><strong>Frage 1:</strong> Was geh√∂rt zu einer vollst√§ndigen Reinigungsdokumentation?</p>
          <label><input type="radio" name="q5" value="1"> Datum, Reinigungsbereich, eingesetztes Mittel</label><br>
          <label><input type="radio" name="q5" value="0"> Nur Datum</label><br>
          <label><input type="radio" name="q5" value="0"> Nur eingesetzte Reinigungsmittel</label><br>
          <button class="btn btn-success mt-2" id="check-q5">Antwort pr√ºfen</button>
          <div id="result-q5" class="mt-2"></div>
        </div>
      </div>
    </div>

    <!-- Sicherheitsvorkehrungen -->
<div class="col-md-6" id="sicherheit">
  <div class="card dashboard-card">
    <h5><i class="fas fa-shield-alt"></i> Sicherheitsvorkehrungen</h5>
    <p>Stelle sicher, dass alle sicherheitsrelevanten Anforderungen umgesetzt werden.</p>
    <ul class="list-group mb-3">
      <li class="list-group-item"><input type="checkbox"> Notausg√§nge nicht blockiert</li>
      <li class="list-group-item"><input type="checkbox"> Feuerl√∂scher zug√§nglich</li>
      <li class="list-group-item"><input type="checkbox"> Schutzkleidung vorhanden</li>
    </ul>
    <button class="btn btn-warning" onclick="toggleQuiz('quiz6')">Quiz starten</button>
    <div class="quiz mt-3" id="quiz6" style="display:none;">
      <p><strong>Frage 1:</strong> Was z√§hlt zu den grundlegenden Sicherheitsvorkehrungen?</p>
      <label><input type="radio" name="q6" value="1"> Freie Notausg√§nge, Feuerl√∂scher, Schutzkleidung</label><br>
      <label><input type="radio" name="q6" value="0"> Nur Feuerl√∂scher</label><br>
      <label><input type="radio" name="q6" value="0"> Schutzkleidung nicht notwendig</label><br>
      <button class="btn btn-success mt-2" id="check-q6">Antwort pr√ºfen</button>
      <div id="result-q6" class="mt-2"></div>
    </div>
  </div>
</div>

  
  </div>
  

  
<!-- Logout Button -->
<div class="text-center mt-4">
  <a href="/logout" class="btn btn-danger">
    <i class="fas fa-sign-out-alt"></i> Abmelden
  </a>
</div>
</div>

<script>
  // Fortschritt und Punkte
  let quizScore = 0;
  let totalQuestions = 0;
  let answeredQuestions = new Set();

  function toggleQuiz(id) {
    const quiz = document.getElementById(id);
    quiz.style.display = quiz.style.display === "none" ? "block" : "none";
  }

  // Punkte pr√ºfen und ausgeben
  document.querySelectorAll('[id^="check-q"]').forEach(button => {
    button.addEventListener("click", () => {
      const qId = button.id.split("-")[1]; // z.B. q1
      const radios = document.querySelectorAll(`input[name="${qId}"]`);
      const resultDiv = document.getElementById(`result-${qId}`);

      if (answeredQuestions.has(qId)) {
        resultDiv.innerHTML = '<span class="text-warning">‚ö†Ô∏è Diese Frage wurde bereits beantwortet.</span>';
        return;
      }

      let correct = false;
      radios.forEach(radio => {
        if (radio.checked && radio.value === "1") correct = true;
      });

      totalQuestions++;
      answeredQuestions.add(qId);

      if (correct) {
        quizScore++;
        resultDiv.innerHTML = '<span class="text-success">‚úÖ Richtig!</span>';
      } else {
        resultDiv.innerHTML = '<span class="text-danger">‚ùå Falsch.</span>';
      }

      checkCompletion();
    });
  });

  function checkCompletion() {
    const totalExpected = document.querySelectorAll('[id^="check-q"]').length;
    if (answeredQuestions.size === totalExpected) {
      showFinalScore();
    }
  }

  function showFinalScore() {
    const msg = `
      <div class="alert alert-info mt-4">
        <h5>üéâ Quiz abgeschlossen!</h5>
        <p>Du hast <strong>${quizScore}</strong> von <strong>${totalQuestions}</strong> Fragen richtig beantwortet.</p>
        ${quizScore === totalQuestions ? "<p class='text-success'>Perfekt! üèÜ</p>" : "<p>Gut gemacht! üí™</p>"}
      </div>
    `;
    const feedbackContainer = document.createElement("div");
    feedbackContainer.innerHTML = msg;
    document.body.appendChild(feedbackContainer);
  }

  // Check Antworten f√ºr jede Frage
  document.getElementById('check-q1').addEventListener('click', () => checkAnswer('q1', 1));
  document.getElementById('check-q2').addEventListener('click', () => checkAnswer('q2', 1));
  document.getElementById('check-q3').addEventListener('click', () => checkAnswer('q3', 1));
  document.getElementById('check-q4').addEventListener('click', () => checkAnswer('q4', 1));
  document.getElementById('check-q5').addEventListener('click', () => checkAnswer('q5', 1));
  document.getElementById('check-q6').addEventListener('click', () => checkAnswer('q6', 1));
  document.getElementById('check-q7').addEventListener('click', () => checkAnswer('q7', 1));
  document.getElementById('check-q8').addEventListener('click', () => checkAnswer('q8', 1));
  // Reinigung und Wartung Fragen
  document.getElementById('check-q9').addEventListener('click', () => checkAnswer('q9', 1));
  document.getElementById('check-q10').addEventListener('click', () => checkAnswer('q10', 1));

  // Sicherheitsvorkehrungen Fragen
  document.getElementById('check-q11').addEventListener('click', () => checkAnswer('q11', 1));
  document.getElementById('check-q12').addEventListener('click', () => checkAnswer('q12', 1));
    // Dokumentation ‚Äì weitere Fragen (falls vorhanden)
  document.getElementById('check-q13').addEventListener('click', () => checkAnswer('q13', 1));
  document.getElementById('check-q14').addEventListener('click', () => checkAnswer('q14', 1));

 // Funktion zur Best√§tigung der Anweisungen im Modal
 document.getElementById('confirmation-form').addEventListener('submit', function(event) {
  event.preventDefault(); // Verhindert das Abschicken des Formulars, damit wir die Best√§tigung anzeigen k√∂nnen

  const employeeName = document.getElementById('employee-name').value;
  const confirmationDate = document.getElementById('confirmation-date').value;
  const understood = document.getElementById('understood').checked;

  if (employeeName && confirmationDate && understood) {
    // Best√§tigung anzeigen
    alert(`Vielen Dank, ${employeeName}! Ihre Best√§tigung wurde f√ºr den ${confirmationDate} gespeichert.`);
    
    // Hier kannst du sp√§ter die Funktion hinzuf√ºgen, um die Best√§tigung in eine Datenbank zu speichern oder ein PDF zu erstellen.
    
    // Formular zur√ºcksetzen
    document.getElementById('confirmation-form').reset();

    // Modal schlie√üen
    var modal = bootstrap.Modal.getInstance(document.getElementById('instructionModal'));
    modal.hide();
  } else {
    alert('Bitte f√ºllen Sie alle Felder aus und best√§tigen Sie, dass Sie die Anweisungen gelesen haben.');
  }
});


</script>


  <div class="modal fade" id="instructionModal" tabindex="-1" aria-labelledby="instructionModalLabel" aria-hidden="true">
    
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
      <img src="/static/images/haccp1.jpg" alt="image" style="width: 100%; height: auto;">
      <div class="modal-content">
        <div class="modal-header" >  
          <h5 class="modal-title" id="instructionModalLabel">Anweisungen f√ºr neue Mitarbeiter ‚Äì HACCP & Honigproduktion</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
  
          <h6><strong>Einf√ºhrung in HACCP & Honigproduktion</strong></h6>
          <p>HACCP hilft uns, gesundheitssch√§dliche oder minderwertige Produkte zu vermeiden. Wir handeln pr√§ventiv, bevor etwas schiefl√§uft.</p>
  
          <h6><strong>1. Pers√∂nliche Hygienevorschriften</strong></h6>
          <p>Bevor du den Produktionsbereich betrittst:</p>
          <ul>
            <li>‚úÖ H√§nde gr√ºndlich waschen und desinfizieren</li>
            <li>‚úÖ Keine Uhren, Ringe oder Schmuck</li>
            <li>‚úÖ Saubere Arbeitskleidung tragen (wird gestellt)</li>
            <li>‚úÖ Haarnetz und ggf. Bartschutz tragen</li>
            <li>‚úÖ Kein starkes Parfum, Make-up o.√§.</li>
            <li>‚úÖ Keine Krankheitssymptome (Erk√§ltung, Durchfall, offene Wunden)</li>
          </ul>
          <p><strong>‚ùó Meldepflicht:</strong> Bei Krankheit oder Auff√§lligkeiten (z.B. Bruch von Glas) sofort melden!</p>
  
          <h6><strong>2. Zutritt zur Produktionsst√§tte</strong></h6>
          <ul>
            <li>Nur autorisiertes Personal darf rein</li>
            <li>Fu√üdesinfektionsmatten benutzen</li>
            <li>Sicherheitsunterweisung beachten (Fluchtwege, Feuerl√∂scher etc.)</li>
          </ul>
  
          <h6><strong>3. Umgang mit Rohhonig und Materialien</strong></h6>
          <h6>A. Rohhonigannahme:</h6>
          <ul>
            <li>Temperatur & Feuchtigkeit pr√ºfen</li>
            <li>Sensorische Kontrolle: Farbe, Geruch</li>
            <li>Protokollieren: Charge, Lieferant, Datum</li>
          </ul>
          <h6>B. Lagerung:</h6>
          <ul>
            <li>Trocken, dunkel, bei ca. 15‚Äì20 ¬∞C</li>
            <li>Kein Kontakt zu Reinigungsmitteln oder Fremdger√ºchen</li>
          </ul>
  
          <h6><strong>4. Kritische Kontrollpunkte (CCP) in der Produktion</strong></h6>
          <h6>CCP1: Filtration / Siebung:</h6>
          <ul>
            <li>Entfernt Wachspartikel, Bienenreste etc.</li>
            <li>Temperatur < 40 ¬∞C (Enzyme im Honig sind hitzeempfindlich)</li>
            <li>Siebe regelm√§√üig reinigen & auf Sch√§den pr√ºfen</li>
          </ul>
          <h6>CCP2: Abf√ºllung:</h6>
          <ul>
            <li>Keine Fremdk√∂rper (Glassplitter, Dichtungsr√ºckst√§nde etc.)</li>
            <li>Hygienisch einwandfreie Beh√§lter benutzen</li>
            <li>Waagen kalibriert? F√ºllmenge pr√ºfen!</li>
          </ul>
          <h6>CCP3: Etikettierung:</h6>
          <ul>
            <li>Korrekte Produktinfos (Sortenname, MHD, Ursprungsland)</li>
            <li>R√ºckverfolgbarkeit gew√§hrleisten (Chargennummer muss drauf!)</li>
          </ul>
  
          <h6><strong>5. Reinigung & Desinfektion (Reinigungsplan)</strong></h6>
          <ul>
            <li>T√§glich: Oberfl√§chen, Arbeitsger√§te, B√∂den</li>
            <li>W√∂chentlich: Maschinen gr√ºndlich reinigen</li>
            <li>Dokumentieren, was, wann, womit gereinigt wurde</li>
            <li>Nur freigegebene Reinigungsmittel verwenden (nicht in Kontakt mit Honig!)</li>
          </ul>
  
          <h6><strong>6. Dokumentation (dein bester Freund)</strong></h6>
          <p>Du musst alles, was mit Sicherheit zu tun hat, dokumentieren:</p>
          <ul>
            <li>Temperaturprotokolle</li>
            <li>Reinigungstagebuch</li>
            <li>Rohstoffeingang / -freigabe</li>
            <li>St√∂rungen oder Zwischenf√§lle</li>
            <li>Wartungs- und Kalibrierpl√§ne</li>
          </ul>
          <p><strong>Merke:</strong> ‚ÄûWas nicht dokumentiert ist, gilt als nicht gemacht.‚Äú</p>
  
          <h6><strong>7. Was tun bei Problemen?</strong></h6>
          <p>Wenn du bemerkst, dass:</p>
          <ul>
            <li>Ein Produkt verdorben sein k√∂nnte</li>
            <li>Du etwas Ungew√∂hnliches siehst (z.‚ÄØB. Schimmel, Fremdk√∂rper)</li>
            <li>Eine Maschine defekt ist</li>
          </ul>
          <p><strong>SOFORT STOPPEN</strong> und Schichtleiter / Qualit√§tsbeauftragten informieren!</p>
  
          <h6><strong>8. Extra: Besondere Risiken in der Honigproduktion</strong></h6>
          <ul>
            <li>Antibiotikar√ºckst√§nde im Importhonig</li>
            <li>Kristallisation falsch gelagerter Produkte</li>
            <li>Verwechslung von Sorten</li>
            <li>Ungewollte Fermentation (zu hoher Wassergehalt)</li>
          </ul>
  
          <hr>
          <h6 class="mt-4"><strong>Best√§tigung</strong></h6>
          <p>Bitte f√ºlle dieses Formular aus, um zu best√§tigen, dass du alle Informationen gelesen und verstanden hast:</p>
  
          <!-- Formular f√ºr Best√§tigung -->
          <form id="confirmation-form">
            <div class="mb-3">
              <label for="instructor-name" class="form-label fw-bold">Durchgef√ºhrt von</label>
              <input type="text" class="form-control" id="instructor-name" placeholder="z.‚ÄØB. Hygienebeauftragter" required>
            </div>
            
            <div class="mb-3">
              <label for="instruction-version" class="form-label fw-bold">Version der Anweisung</label>
              <input type="text" class="form-control" id="instruction-version" placeholder="z.‚ÄØB. Version 1.2, Stand 03/2024" required>
            </div>
            
            <div class="mb-3">
              <label for="employee-role" class="form-label fw-bold">Position/Funktion der angewiesenen Person</label>
              <input type="text" class="form-control" id="employee-role" placeholder="z.‚ÄØB. Produktionsmitarbeiter" required>
            </div>
            
            <div class="mb-3">
              <label for="employee-fullname" class="form-label fw-bold">Vollst√§ndiger Name des Mitarbeiters</label>
              <input type="text" class="form-control" id="employee-fullname" placeholder="Vorname Nachname" required>
            </div>
  
            <div class="mb-3">
              <label for="employee-id" class="form-label fw-bold">Betriebsnummer</label>
              <input type="text" class="form-control" id="employee-id" placeholder="z.‚ÄØB. 12345678" required>
            </div>
  
            <div class="mb-3">
              <label for="confirmation-date" class="form-label fw-bold">Best√§tigungsdatum</label>
              <input type="date" class="form-control" id="confirmation-date" required>
            </div>
            
              <!-- Erscheinungsbild-Dokumentation -->
            <div class="mb-3">
              <label for="erscheinungsbild" class="form-label fw-bold">
                Erscheinungsbild der eingewiesenen Person:
              </label>
              <textarea class="form-control" id="erscheinungsbild" rows="3" placeholder="Hier wird das √§u√üere Erscheinungsbild dokumentiert ‚Äì z.‚ÄØB. gepflegte Kleidung, sauberes Auftreten etc."></textarea>
            </div>
           
            <div class="mb-3">
              <hr>
              <p><strong>Datenschutzhinweis:</strong><br>
              Mit seiner Unterschrift erkl√§rt sich der Unterzeichner ausdr√ºcklich damit einverstanden, dass seine personenbezogenen Daten zum Zwecke der internen Dokumentation, Schulungsnachweises und Kommunikation in einem privaten Cloud-Dienst gespeichert und verarbeitet werden. Die Speicherung erfolgt unter Beachtung der geltenden datenschutzrechtlichen Bestimmungen, insbesondere der DSGVO.<br>
              <a href="#" data-bs-toggle="modal" data-bs-target="#datenschutzModal">Vollst√§ndige Datenschutzerkl√§rung anzeigen</a>
              </p>

              <label class="form-label fw-bold">Unterschrift (mit Maus oder Finger)</label>
              <canvas id="signature-pad" width="600" height="200" class="border" style="border: 1px solid #ccc; width: 100%;"></canvas>
              <button type="button" class="btn btn-secondary btn-sm mt-2" onclick="clearSignature()">Unterschrift l√∂schen</button>
            </div>

            <div class="form-check mb-3">
              <input type="checkbox" class="form-check-input" id="understood" required>
              <label class="form-check-label fw-bold" for="understood">Ich habe die Anweisungen gelesen und verstanden.</label>
            </div>
  
            <button type="submit" class="btn btn-success mt-3">Best√§tigen</button>
          </form>
  
        </div>
      </div>
    </div>
  </div>

  <!-- Datenschutz Modal -->
<div class="modal fade" id="datenschutzModal" tabindex="-1" aria-labelledby="datenschutzModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="datenschutzModalLabel">Datenschutzerkl√§rung</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Schlie√üen"></button>
      </div>
      <div class="modal-body">
        <p><strong>Verantwortlicher:</strong><br>Imkerei Mustermann, Musterstra√üe 1, 12345 Musterstadt</p>

        <p><strong>Zweck der Datenverarbeitung:</strong><br>
        Ihre personenbezogenen Daten (Name, Unterschrift, Schulungsteilnahme) werden zum Zwecke der internen Schulungsdokumentation, Qualit√§tskontrolle sowie der Einhaltung gesetzlicher Nachweispflichten gespeichert.</p>

        <p><strong>Rechtsgrundlage:</strong><br>
        Ihre Einwilligung gem√§√ü Art. 6 Abs. 1 lit. a DSGVO.</p>

        <p><strong>Speicherdauer:</strong><br>
        Die Daten werden f√ºr die Dauer der Betriebszugeh√∂rigkeit und dar√ºber hinaus f√ºr maximal 3 Jahre gespeichert, sofern keine l√§ngeren gesetzlichen Aufbewahrungspflichten bestehen.</p>

        <p><strong>Empf√§nger:</strong><br>
        Der Zugriff erfolgt ausschlie√ülich durch autorisierte Personen innerhalb des Unternehmens. Die Daten werden in einer gesch√ºtzten privaten Cloud gespeichert.</p>

        <p><strong>Ihre Rechte:</strong><br>
        Sie haben das Recht auf Auskunft, Berichtigung, L√∂schung, Einschr√§nkung der Verarbeitung, Daten√ºbertragbarkeit und Widerruf Ihrer Einwilligung. Wenden Sie sich dazu an: <a href="mailto:datenschutz@imkerei.de">datenschutz@imkerei.de</a></p>
      </div>
    </div>
  </div>
</div>
  
<script>
  const datenschutzModal = document.getElementById('datenschutzModal');
  datenschutzModal.addEventListener('hidden.bs.modal', function () {
    const instructionModal = new bootstrap.Modal(document.getElementById('instructionModal'));
    instructionModal.show();
  });
</script>
 

<script>
    document.getElementById("confirmation-form").addEventListener("submit", async function(e) {
    e.preventDefault();

    const name = document.getElementById("employee-fullname").value;
    const id = document.getElementById("employee-id").value;
    const date = document.getElementById("confirmation-date").value;
    const instructor = document.getElementById("instructor-name").value;
    const version = document.getElementById("instruction-version").value;
    const role = document.getElementById("employee-role").value;  
    const canvas = document.getElementById("signature-pad");
    const signatureDataUrl = canvas.toDataURL();

    // 1. Sende Daten an Server
    const response = await fetch("/confirmation", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        employee_name: name,
        employee_number: id,
        confirmation_date: date,
        signature: signatureDataUrl,
        instructor_name: instructor,
        instruction_version: version,
        employee_role: role
      })
    });

    if (response.ok) {
      alert("Best√§tigung erfolgreich gespeichert.");
    } else {
      alert("Fehler beim Speichern der Best√§tigung.");
    }

    const { jsPDF } = window.jspdf;
const doc = new jsPDF();

// F√ºge das Firmenlogo (lokale Datei) hinzu
const logoUrl = '/static/images/logo.jpg';  // Der Pfad zur Logo-Datei
doc.addImage(logoUrl, 'JPEG', 10, 10, 80, 33);  // Kleineres Logo in der oberen linken Ecke

// F√ºge die Firmeninformationen hinzu und verkleinere sie
doc.setFontSize(9);
doc.text("Firma: Bee United UG", 130, 15); // Rechts neben dem Logo
doc.text("Kontakt: info@beeunitedug.de", 130, 22); 
doc.text("Telefon: +49 123 456 7890", 130, 29); 
doc.text("Adresse: Schaaffhausenstra√üe 2, 50769 K√∂ln", 130, 36); 

// Horizontale Linie unter dem Logo und Firmeninformationen
doc.setDrawColor(0);
doc.setLineWidth(0.5);
doc.line(10, 45, 200, 45);

// Setze die Schriftgr√∂√üe und f√ºge die zentrierte √úberschrift UNTER dem Logo und Kontaktdaten
doc.setFontSize(18);
doc.text("Best√§tigung ‚Äì HACCP Anweisung", 105, 60, null, null, 'center'); 

// Datum und Dokumenteninformation rechts
doc.setFontSize(8);
doc.text(`Datum: ${formatDate(new Date())}`, 170, 75);

// F√ºge die Best√§tigungsdaten hinzu
doc.setFontSize(11);
doc.text("Personendaten:", 10, 85);
doc.setFontSize(10);
doc.text(`Name des Mitarbeiters: ${name}`, 20, 95);
doc.text(`Betriebsnummer: ${id}`, 20, 105);
doc.text(`Position/Funktion: ${role}`, 20, 115);

// HACCP Details
doc.setFontSize(11);
doc.text("Anweisungsdetails:", 10, 135);
doc.setFontSize(10);
doc.text(`Best√§tigungsdatum: ${formatDate(date)}`, 20, 145);
doc.text(`Version der Anweisung: ${version}`, 20, 155);
doc.text(`Anweisung durchgef√ºhrt von: ${instructor}`, 20, 165);

// Best√§tigungsbereich
doc.setFontSize(11);
doc.text("Best√§tigung:", 10, 185);
doc.setFontSize(10);
doc.text(`Gelesen & verstanden: ‚òë Ja`, 20, 195);

// Unterschriftsbereich
doc.text("Unterschrift:", 10, 215);
doc.addImage(signatureDataUrl, "PNG", 20, 220, 90, 30);  // Position angepasst

// Fu√üzeile
doc.setFontSize(8);
doc.setTextColor(100, 100, 100); // Grauer Text
doc.text("Dieses Dokument wurde elektronisch erstellt und ben√∂tigt keine physische Unterschrift zur G√ºltigkeit.", 105, 260, null, null, 'center');
doc.text("¬© Bee United UG | HACCP-Dokumentation", 105, 270, null, null, 'center');

// Speichere das PDF
doc.save(`HACCP-Bestaetigung_${name.replace(/\s+/g, "_")}.pdf`);

// Benachrichtigung
alert("Vielen Dank! Deine Best√§tigung wurde als PDF gespeichert.");

// Hilfsfunktion, um das Datum im EU-Format zu formatieren (TT.MM.JJJJ)
function formatDate(date) {
  const dateObj = new Date(date);
  const day = String(dateObj.getDate()).padStart(2, '0');
  const month = String(dateObj.getMonth() + 1).padStart(2, '0'); // Monate sind 0-basiert
  const year = dateObj.getFullYear();
  return `${day}.${month}.${year}`;
}



  });
</script>
<script>
  const canvas = document.getElementById("signature-pad");
  const ctx = canvas.getContext("2d");
  let drawing = false;

  function getPosition(e) {
    const rect = canvas.getBoundingClientRect();
    return {
      x: (e.clientX || e.touches[0].clientX) - rect.left,
      y: (e.clientY || e.touches[0].clientY) - rect.top
    };
  }

  function startDraw(e) {
    e.preventDefault();
    drawing = true;
    const pos = getPosition(e);
    ctx.beginPath();
    ctx.moveTo(pos.x, pos.y);
  }

  function draw(e) {
    if (!drawing) return;
    e.preventDefault();
    const pos = getPosition(e);
    ctx.lineTo(pos.x, pos.y);
    ctx.strokeStyle = "#000";
    ctx.lineWidth = 2;
    ctx.stroke();
  }

  function stopDraw(e) {
    e.preventDefault();
    drawing = false;
  }

  function clearSignature() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }

  // Events f√ºr Maus
  canvas.addEventListener("mousedown", startDraw);
  canvas.addEventListener("mousemove", draw);
  canvas.addEventListener("mouseup", stopDraw);
  canvas.addEventListener("mouseleave", stopDraw);

  // Events f√ºr Touchger√§te
  canvas.addEventListener("touchstart", startDraw);
  canvas.addEventListener("touchmove", draw);
  canvas.addEventListener("touchend", stopDraw);
  canvas.addEventListener("touchcancel", stopDraw);
</script>



<!-- Bootstrap JS f√ºr Modal-Funktionalit√§t -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>


</body>
</html>