<!-- dashboard.html -->
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HACCP Dashboard - Bee United UG</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #ffffff;
      font-family: 'Arial', sans-serif;
    }
    .card {
      border-radius: 10px;
      margin-bottom: 20px;
    }
    .nav-link {
      padding: 10px 20px;
      border-radius: 5px;
      margin: 5px;
      text-align: center;
      background-color: #292625;
      color: white;
      text-decoration: none;
    }
    .nav-link:hover {
      background-color: #e6bd39;
    }
    .container {
      max-width: 1200px;
      margin-top: 30px;
    }
    h1 {
      text-align: center;
      color: #343a40;
    }
    .dashboard-card {
      text-align: center;
      padding: 20px;
      background-color: #f3f2e2;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .quiz {
      margin-top: 20px;
      text-align: left;
    }
    .quiz label {
      display: block;
    }
  </style>
</head>
<body>

  
  
<div class="container">
  <div style="display: flex; align-items: center; justify-content: space-between; padding: 10px 20px;">
    <img src="/static/images/logo.jpg" alt="Logo" style="height: 70px;">
    <h1 style="flex: 1; text-align: center; margin: 0;">HACCP Dashboard – Bee United UG</h1>
  </div>
  
  

  <!-- Navigation Menu -->
  <div class="d-flex justify-content-center flex-wrap mb-4">

    <!-- Button zum Öffnen des Modal für neue Mitarbeiter -->
    <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#instructionModal">
      <i class="fas fa-user-plus"></i>  Anweisungen lesen und bestätigen
    </a>
    

    <a href="#produkte" class="nav-link"><i class="fas fa-cogs"></i> Produktbeschreibung</a>
    <a href="#verpackung" class="nav-link"><i class="fas fa-box"></i> Verpackung und Kontakt</a>
    <a href="#lagerung" class="nav-link"><i class="fas fa-warehouse"></i> Lagerung des Honigs</a>
    <a href="#hygiene" class="nav-link"><i class="fas fa-user-check"></i> Hygiene und Kleidung</a>
    <a href="#dokumente" class="nav-link"><i class="fas fa-file-alt"></i> Dokumentation</a>
    <a href="#reinigung" class="nav-link"><i class="fas fa-broom"></i> Reinigung und Wartung</a>
    <a href="#sicherheit" class="nav-link"><i class="fas fa-shield-alt"></i> Sicherheitsvorkehrungen</a>
  </div>


  <div class="row mt-4">
    <!-- Produktbeschreibung -->
    <div class="col-md-6" id="produkte">
      <div class="card dashboard-card">
        <h5><i class="fas fa-cogs"></i> Produktbeschreibung</h5>
        <p>Validiere die Informationen zu den Honigprodukten und deren Herkunft gemäß HACCP.</p>
        <button class="btn btn-warning" onclick="toggleQuiz('quiz1')">Jetzt starten</button>
        <div class="quiz" id="quiz1" style="display:none;">
          <p><strong>Frage 1:</strong> Welche Zertifikate müssen für den Honig vorliegen?</p>
          <label><input type="radio" name="q1" value="1"> QSI und Honigverordnung</label>
          <label><input type="radio" name="q1" value="0"> Nur das Lieferantenzertifikat</label>
          <label><input type="radio" name="q1" value="0"> Keine Zertifikate erforderlich</label>
          <button class="btn btn-success mt-2" id="check-q1">Antwort prüfen</button>
          <div id="result-q1" class="mt-2"></div>

          <p><strong>Frage 2:</strong> Wie lange ist der Honig lagerfähig?</p>
          <label><input type="radio" name="q2" value="1"> 24 Monate</label>
          <label><input type="radio" name="q2" value="0"> 12 Monate</label>
          <label><input type="radio" name="q2" value="0"> 36 Monate</label>
          <button class="btn btn-success mt-2" id="check-q2">Antwort prüfen</button>
          <div id="result-q2" class="mt-2"></div>
        </div>
      </div>
    </div>

    <!-- Verpackung und Kontakt mit Produkt -->
    <div class="col-md-6" id="verpackung">
      <div class="card dashboard-card">
        <h5><i class="fas fa-box"></i> Verpackung und Kontakt mit Produkt</h5>
        <p>Überprüfe die Anforderungen an Verpackungsmaterialien und deren Kontakt mit dem Honig.</p>
        <button class="btn btn-warning" onclick="toggleQuiz('quiz2')">Jetzt starten</button>
        <div class="quiz" id="quiz2" style="display:none;">
          <p><strong>Frage 1:</strong> Welches Material wird für die Verpackung des Honigs verwendet?</p>
          <label><input type="radio" name="q3" value="1"> PET/AL/PE 100 µm</label>
          <label><input type="radio" name="q3" value="0"> Glas</label>
          <label><input type="radio" name="q3" value="0"> Papier</label>
          <button class="btn btn-success mt-2" id="check-q3">Antwort prüfen</button>
          <div id="result-q3" class="mt-2"></div>

          <p><strong>Frage 2:</strong> Welche Anforderungen gelten für den Kontakt zwischen Honig und Verpackungsmaterial?</p>
          <label><input type="radio" name="q4" value="1"> Der innere PE-Layer darf den Honig berühren</label>
          <label><input type="radio" name="q4" value="0"> Der Honig darf nie den Verpackungslayer berühren</label>
          <label><input type="radio" name="q4" value="0"> Es sind keine besonderen Anforderungen nötig</label>
          <button class="btn btn-success mt-2" id="check-q4">Antwort prüfen</button>
          <div id="result-q4" class="mt-2"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="row mt-4">
    <!-- Lagerung des Honigs -->
    <div class="col-md-6" id="lagerung">
      <div class="card dashboard-card">
        <h5><i class="fas fa-warehouse"></i> Lagerung des Honigs</h5>
        <p>Überprüfe die korrekten Lagerbedingungen für den Honig.</p>
        <button class="btn btn-warning" onclick="toggleQuiz('quiz3')">Jetzt starten</button>
        <div class="quiz" id="quiz3" style="display:none;">
          <p><strong>Frage 1:</strong> Wie lange darf der Honig im Lager aufbewahrt werden?</p>
          <label><input type="radio" name="q5" value="1"> Maximal 5-7 Tage</label>
          <label><input type="radio" name="q5" value="0"> 2 Wochen</label>
          <label><input type="radio" name="q5" value="0"> 1 Monat</label>
          <button class="btn btn-success mt-2" id="check-q5">Antwort prüfen</button>
          <div id="result-q5" class="mt-2"></div>

          <p><strong>Frage 2:</strong> Welche Anforderungen gelten für die Lagerung des Honigs?</p>
          <label><input type="radio" name="q6" value="1"> In einem sauberen und trockenen Raum</label>
          <label><input type="radio" name="q6" value="0"> In einem offenen Lagerraum</label>
          <label><input type="radio" name="q6" value="0"> In direkter Sonneneinstrahlung</label>
          <button class="btn btn-success mt-2" id="check-q6">Antwort prüfen</button>
          <div id="result-q6" class="mt-2"></div>
        </div>
      </div>
    </div>

    <!-- Hygiene und Kleidung -->
    <div class="col-md-6" id="hygiene">
      <div class="card dashboard-card">
        <h5><i class="fas fa-user-check"></i> Hygiene und Kleidung</h5>
        <p>Überprüfe, dass alle Hygieneregeln und Vorschriften für das Personal eingehalten werden.</p>
        <button class="btn btn-warning" onclick="toggleQuiz('quiz4')">Jetzt starten</button>
        <div class="quiz" id="quiz4" style="display:none;">
          <p><strong>Frage 1:</strong> Welche Hygienemaßnahmen sind für das Personal erforderlich?</p>
          <label><input type="radio" name="q7" value="1"> Hände waschen, Haarnetz und Schutzkleidung tragen</label>
          <label><input type="radio" name="q7" value="0"> Keine speziellen Anforderungen</label>
          <label><input type="radio" name="q7" value="0"> Nur Handschuhe tragen</label>
          <button class="btn btn-success mt-2" id="check-q7">Antwort prüfen</button>
          <div id="result-q7" class="mt-2"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="row mt-4">
    <!-- Dokumentation -->
    <div class="col-md-6" id="dokumente">
      <div class="card dashboard-card">
        <h5><i class="fas fa-file-alt"></i> Dokumentation</h5>
        <p>Verwalte die erforderliche Dokumentation und Aufzeichnungen für HACCP.</p>
        <button class="btn btn-warning" onclick="toggleQuiz('quiz5')">Jetzt starten</button>
        <div class="quiz" id="quiz5" style="display:none;">
          <p><strong>Frage 1:</strong> Welche Dokumente müssen geführt werden?</p>
          <label><input type="radio" name="q8" value="1"> Kontroll- und Wartungsprotokolle, Zertifikate</label>
          <label><input type="radio" name="q8" value="0"> Nur Produktionsberichte</label>
          <label><input type="radio" name="q8" value="0"> Keine Dokumente erforderlich</label>
          <button class="btn btn-success mt-2" id="check-q8">Antwort prüfen</button>
          <div id="result-q8" class="mt-2"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Logout Button -->
<div class="text-center mt-4">
  <a href="/logout" class="btn btn-danger">
    <i class="fas fa-sign-out-alt"></i> Abmelden
  </a>
</div>
</div>

<script>
  // Funktion zum Umschalten der Quizzes
  function toggleQuiz(quizId) {
    const quiz = document.getElementById(quizId);
    if (quiz.style.display === "none") {
      quiz.style.display = "block";
    } else {
      quiz.style.display = "none";
    }
  }

  // Überprüfungsfunktion für jede Frage
  function checkAnswer(questionId, correctAnswer) {
    const selectedAnswer = document.querySelector(`input[name="${questionId}"]:checked`);
    const result = document.getElementById(`result-${questionId}`);
    if (selectedAnswer) {
      if (selectedAnswer.value == correctAnswer) {
        result.innerHTML = "<span style='color: green;'>Richtig!</span>";
      } else {
        result.innerHTML = "<span style='color: red;'>Falsch!</span>";
      }
    } else {
      result.innerHTML = "<span style='color: orange;'>Bitte eine Antwort wählen.</span>";
    }
  }

  // Check Antworten für jede Frage
  document.getElementById('check-q1').addEventListener('click', () => checkAnswer('q1', 1));
  document.getElementById('check-q2').addEventListener('click', () => checkAnswer('q2', 1));
  document.getElementById('check-q3').addEventListener('click', () => checkAnswer('q3', 1));
  document.getElementById('check-q4').addEventListener('click', () => checkAnswer('q4', 1));
  document.getElementById('check-q5').addEventListener('click', () => checkAnswer('q5', 1));
  document.getElementById('check-q6').addEventListener('click', () => checkAnswer('q6', 1));
  document.getElementById('check-q7').addEventListener('click', () => checkAnswer('q7', 1));
  document.getElementById('check-q8').addEventListener('click', () => checkAnswer('q8', 1));

 // Funktion zur Bestätigung der Anweisungen im Modal
 document.getElementById('confirmation-form').addEventListener('submit', function(event) {
  event.preventDefault(); // Verhindert das Abschicken des Formulars, damit wir die Bestätigung anzeigen können

  const employeeName = document.getElementById('employee-name').value;
  const confirmationDate = document.getElementById('confirmation-date').value;
  const understood = document.getElementById('understood').checked;

  if (employeeName && confirmationDate && understood) {
    // Bestätigung anzeigen
    alert(`Vielen Dank, ${employeeName}! Ihre Bestätigung wurde für den ${confirmationDate} gespeichert.`);
    
    // Hier kannst du später die Funktion hinzufügen, um die Bestätigung in eine Datenbank zu speichern oder ein PDF zu erstellen.
    
    // Formular zurücksetzen
    document.getElementById('confirmation-form').reset();

    // Modal schließen
    var modal = bootstrap.Modal.getInstance(document.getElementById('instructionModal'));
    modal.hide();
  } else {
    alert('Bitte füllen Sie alle Felder aus und bestätigen Sie, dass Sie die Anweisungen gelesen haben.');
  }
});


</script>

<!-- Modal für Anweisungen -->
<div class="modal fade" id="instructionModal" tabindex="-1" aria-labelledby="instructionModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="instructionModalLabel">Anweisungen für neue Mitarbeiter – HACCP & Honigproduktion</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <h6><strong>Willkommen!</strong></h6>
        <p>Diese Schulung hilft dir, unsere Regeln zu verstehen. Bitte lies alle Punkte sorgfältig durch – am Ende bestätigst du, dass du sie verstanden hast.</p>

        <h6><strong>1. Was ist HACCP?</strong></h6>
        <p>HACCP ist ein Sicherheitskonzept, das hilft, Gefahren beim Umgang mit Lebensmitteln zu erkennen und zu vermeiden. In unserer Honigproduktion achten wir besonders auf:</p>
        <ul>
          <li>🦠 <strong>Biologische Gefahren</strong>: z. B. Bakterien oder Schimmel</li>
          <li>🧪 <strong>Chemische Gefahren</strong>: z. B. Reinigungsmittel</li>
          <li>🔩 <strong>Physikalische Gefahren</strong>: z. B. Metall- oder Glasstücke</li>
        </ul>
        <img src="https://cdn.pixabay.com/photo/2016/11/22/19/13/haccp-1853416_960_720.png" class="img-fluid rounded mb-3" alt="HACCP Prinzipien">

        <h6><strong>2. Unsere Sicherheitsmaßnahmen</strong></h6>
        <p>Wir kontrollieren besonders wichtige Schritte in der Produktion, sogenannte CCPs (Kritische Kontrollpunkte):</p>
        <ul>
          <li><strong>Filtration</strong>: Entfernt Fremdkörper</li>
          <li><strong>Lagerung</strong>: Immer unter 20 °C</li>
          <li><strong>Abfüllung</strong>: Alles muss sauber und hygienisch sein</li>
        </ul>
        <p><strong>Wichtige Grenzwerte:</strong></p>
        <ul>
          <li>Wassergehalt im Honig: max. 18 %</li>
          <li>Lagertemperatur: konstant unter 20 °C</li>
        </ul>
        <img src="https://cdn.pixabay.com/photo/2019/08/06/18/13/beekeeper-4387793_960_720.jpg" class="img-fluid rounded mb-3" alt="Honigproduktion">

        <h6><strong>3. Hygiene und Verhalten</strong></h6>
        <ul>
          <li>Trage saubere Arbeitskleidung und ein Haarnetz</li>
          <li>Wasche und desinfiziere regelmäßig deine Hände</li>
          <li>Keine Handys, Schmuck oder private Gegenstände im Produktionsbereich</li>
        </ul>
        <img src="https://cdn.pixabay.com/photo/2020/05/13/08/40/covid-19-5163131_960_720.jpg" class="img-fluid rounded mb-3" alt="Hygienevorschriften">

        <h6><strong>4. Honig richtig lagern</strong></h6>
        <ul>
          <li>Lagere Honig in sauberen, trockenen, dunklen Räumen</li>
          <li>Temperatur konstant halten – ideal: 14–18 °C</li>
          <li>Honiggefäße klar beschriften (Datum & Charge)</li>
        </ul>

        <h6><strong>5. Reinigung der Geräte</strong></h6>
        <ul>
          <li>Reinige alle Geräte direkt nach der Benutzung</li>
          <li>Nur zugelassene Reinigungsmittel verwenden</li>
          <li>Dokumentiere jede Reinigung (Datum, Uhrzeit, Name)</li>
        </ul>

        <h6><strong>6. Alles dokumentieren</strong></h6>
        <ul>
          <li>Produktions- und Reinigungsschritte dokumentieren</li>
          <li>Temperatur und Wassergehalt regelmäßig messen & eintragen</li>
          <li>Checklisten vollständig und lesbar ausfüllen</li>
        </ul>
        <img src="https://cdn.pixabay.com/photo/2016/02/19/10/00/checklist-1209418_960_720.jpg" class="img-fluid rounded mb-3" alt="Checkliste und Dokumentation">

        <h6><strong>7. Gesetze & Vorschriften</strong></h6>
        <p>Wir halten uns an folgende Vorschriften:</p>
        <ul>
          <li><a href="https://www.gesetze-im-internet.de/honigv_2004/BJNR009200004.html" target="_blank">Honigverordnung (DE)</a></li>
          <li><a href="https://de.wikipedia.org/wiki/Lebensmittelhygiene-Verordnung" target="_blank">Lebensmittelhygiene-Verordnung</a></li>
          <li>EU-Verordnung 852/2004 – Hygiene bei Lebensmitteln</li>
        </ul>

        <hr>
        <h6 class="mt-4"><strong>Bestätigung</strong></h6>
        <p>Bitte fülle dieses Formular aus, um zu bestätigen, dass du alle Informationen gelesen und verstanden hast:</p>

       
        <!-- Formular für Bestätigung -->
        <form id="confirmation-form">
          <div class="mb-3">
            <label for="instructor-name" class="form-label">Durchgeführt von</label>
            <input type="text" class="form-control" id="instructor-name" placeholder="z. B. Hygienebeauftragter" required>
          </div>
          
          <div class="mb-3">
            <label for="instruction-version" class="form-label">Version der Anweisung</label>
            <input type="text" class="form-control" id="instruction-version" placeholder="z. B. Version 1.2, Stand 03/2024" required>
          </div>
          
          <div class="mb-3">
            <label for="employee-role" class="form-label">Position/Funktion der angewiesenen Person</label>
            <input type="text" class="form-control" id="employee-role" placeholder="z. B. Küchenhilfe" required>
          </div>
          
          <div class="mb-3">
            <label for="employee-fullname" class="form-label">Vollständiger Name des Mitarbeiters</label>
            <input type="text" class="form-control" id="employee-fullname" placeholder="Vorname Nachname" required>
          </div>

          <div class="mb-3">
            <label for="employee-id" class="form-label">Betriebsnummer</label>
            <input type="text" class="form-control" id="employee-id" placeholder="z. B. 12345678" required>
          </div>

          <div class="mb-3">
            <label for="confirmation-date" class="form-label">Bestätigungsdatum</label>
            <input type="date" class="form-control" id="confirmation-date" required>
          </div>

          <div class="form-check mb-3">
            <input type="checkbox" class="form-check-input" id="understood" required>
            <label class="form-check-label" for="understood">Ich habe die Anweisungen gelesen und verstanden.</label>
          </div>

          <div class="mb-3">
            <label class="form-label">Unterschrift (mit Maus oder Finger)</label>
            <canvas id="signature-pad" width="600" height="200" class="border" style="border: 1px solid #ccc; width: 100%;"></canvas>
            <button type="button" class="btn btn-secondary btn-sm mt-2" onclick="clearSignature()">Unterschrift löschen</button>
          </div>
          

          <button type="submit" class="btn btn-success mt-3">Bestätigen</button>
        </form>

      </div>
    </div>
  </div>
</div>

<script>
    document.getElementById("confirmation-form").addEventListener("submit", async function(e) {
    e.preventDefault();

    const name = document.getElementById("employee-fullname").value;
    const id = document.getElementById("employee-id").value;
    const date = document.getElementById("confirmation-date").value;
    const instructor = document.getElementById("instructor-name").value;
    const version = document.getElementById("instruction-version").value;
    const role = document.getElementById("employee-role").value;  
    const canvas = document.getElementById("signature-pad");
    const signatureDataUrl = canvas.toDataURL();

    // 1. Sende Daten an Server
    const response = await fetch("/confirmation", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        employee_name: name,
        employee_number: id,
        confirmation_date: date,
        signature: signatureDataUrl,
        instructor_name: instructor,
        instruction_version: version,
        employee_role: role
      })
    });

    if (response.ok) {
      alert("Bestätigung erfolgreich gespeichert.");
    } else {
      alert("Fehler beim Speichern der Bestätigung.");
    }

    const { jsPDF } = window.jspdf;
const doc = new jsPDF();

// Füge das Firmenlogo (lokale Datei) hinzu
const logoUrl = '/static/images/logo.jpg';  // Der Pfad zur Logo-Datei
doc.addImage(logoUrl, 'JPEG', 10, 10, 80, 33);  // Kleineres Logo in der oberen linken Ecke

// Füge die Firmeninformationen hinzu und verkleinere sie
doc.setFontSize(9);
doc.text("Firma: Bee United UG", 130, 15); // Rechts neben dem Logo
doc.text("Kontakt: info@beeunitedug.de", 130, 22); 
doc.text("Telefon: +49 123 456 7890", 130, 29); 
doc.text("Adresse: Schaaffhausenstraße 2, 50769 Köln", 130, 36); 

// Horizontale Linie unter dem Logo und Firmeninformationen
doc.setDrawColor(0);
doc.setLineWidth(0.5);
doc.line(10, 45, 200, 45);

// Setze die Schriftgröße und füge die zentrierte Überschrift UNTER dem Logo und Kontaktdaten
doc.setFontSize(18);
doc.text("Bestätigung – HACCP Anweisung", 105, 60, null, null, 'center'); 

// Datum und Dokumenteninformation rechts
doc.setFontSize(8);
doc.text(`Datum: ${formatDate(new Date())}`, 170, 75);

// Füge die Bestätigungsdaten hinzu
doc.setFontSize(11);
doc.text("Personendaten:", 10, 85);
doc.setFontSize(10);
doc.text(`Name des Mitarbeiters: ${name}`, 20, 95);
doc.text(`Betriebsnummer: ${id}`, 20, 105);
doc.text(`Position/Funktion: ${role}`, 20, 115);

// HACCP Details
doc.setFontSize(11);
doc.text("Anweisungsdetails:", 10, 135);
doc.setFontSize(10);
doc.text(`Bestätigungsdatum: ${formatDate(date)}`, 20, 145);
doc.text(`Version der Anweisung: ${version}`, 20, 155);
doc.text(`Anweisung durchgeführt von: ${instructor}`, 20, 165);

// Bestätigungsbereich
doc.setFontSize(11);
doc.text("Bestätigung:", 10, 185);
doc.setFontSize(10);
doc.text(`Gelesen & verstanden: ☑ Ja`, 20, 195);

// Unterschriftsbereich
doc.text("Unterschrift:", 10, 215);
doc.addImage(signatureDataUrl, "PNG", 20, 220, 90, 30);  // Position angepasst

// Fußzeile
doc.setFontSize(8);
doc.setTextColor(100, 100, 100); // Grauer Text
doc.text("Dieses Dokument wurde elektronisch erstellt und benötigt keine physische Unterschrift zur Gültigkeit.", 105, 260, null, null, 'center');
doc.text("© Bee United UG | HACCP-Dokumentation", 105, 270, null, null, 'center');

// Speichere das PDF
doc.save(`HACCP-Bestaetigung_${name.replace(/\s+/g, "_")}.pdf`);

// Benachrichtigung
alert("Vielen Dank! Deine Bestätigung wurde als PDF gespeichert.");

// Hilfsfunktion, um das Datum im EU-Format zu formatieren (TT.MM.JJJJ)
function formatDate(date) {
  const dateObj = new Date(date);
  const day = String(dateObj.getDate()).padStart(2, '0');
  const month = String(dateObj.getMonth() + 1).padStart(2, '0'); // Monate sind 0-basiert
  const year = dateObj.getFullYear();
  return `${day}.${month}.${year}`;
}



  });
</script>
<script>
  const canvas = document.getElementById("signature-pad");
  const ctx = canvas.getContext("2d");
  let drawing = false;

  function getPosition(e) {
    const rect = canvas.getBoundingClientRect();
    return {
      x: (e.clientX || e.touches[0].clientX) - rect.left,
      y: (e.clientY || e.touches[0].clientY) - rect.top
    };
  }

  function startDraw(e) {
    e.preventDefault();
    drawing = true;
    const pos = getPosition(e);
    ctx.beginPath();
    ctx.moveTo(pos.x, pos.y);
  }

  function draw(e) {
    if (!drawing) return;
    e.preventDefault();
    const pos = getPosition(e);
    ctx.lineTo(pos.x, pos.y);
    ctx.strokeStyle = "#000";
    ctx.lineWidth = 2;
    ctx.stroke();
  }

  function stopDraw(e) {
    e.preventDefault();
    drawing = false;
  }

  function clearSignature() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }

  // Events für Maus
  canvas.addEventListener("mousedown", startDraw);
  canvas.addEventListener("mousemove", draw);
  canvas.addEventListener("mouseup", stopDraw);
  canvas.addEventListener("mouseleave", stopDraw);

  // Events für Touchgeräte
  canvas.addEventListener("touchstart", startDraw);
  canvas.addEventListener("touchmove", draw);
  canvas.addEventListener("touchend", stopDraw);
  canvas.addEventListener("touchcancel", stopDraw);
</script>



<!-- Bootstrap JS für Modal-Funktionalität -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>


</body>
</html>